<!-- src/app/pages/users/admin-add-user/admin-add-user.component.html -->
<div class="admin-user-container">
    <div class="admin-user-form">
        <div class="admin-header">
            <h2 translate>
                {{ isEditMode ? 'Modifier l\'utilisateur' : 'Cr√©er un utilisateur' }}
            </h2>
            <div class="admin-badge">
                <span class="badge">Mode Administrateur</span>
            </div>
        </div>

        <!-- Messages -->
        <div *ngIf="errorMessage" class="alert alert-error">
            {{ errorMessage }}
        </div>

        <div *ngIf="successMessage" class="alert alert-success">
            {{ successMessage }}
        </div>

        <form [formGroup]="adminForm" (ngSubmit)="onSubmit()">

            <!-- S√©lection du r√¥le (sp√©cifique admin) -->
            <div class="form-group admin-only">
                <label for="role" translate>R√¥le utilisateur (*)</label>
                <select 
                    id="role"
                    formControlName="selectedRole"
                    [class.error]="isFieldInvalid('selectedRole')"
                    class="role-select"
                    >
                    <option value="">-- S√©lectionner un r√¥le --</option>
                    <option value="ROLE_USER">üë§ Utilisateur Standard</option>
                    <option value="ROLE_ADMIN">‚ö° Administrateur</option>
                </select>
                <div *ngIf="isFieldInvalid('selectedRole')" class="error-message">
                    Un r√¥le doit √™tre s√©lectionn√©
                </div>
                <small class="help-text">Ce champ d√©termine les permissions de l'utilisateur dans l'application</small>
            </div>

            <!-- Cr√©dit initial (sp√©cifique admin) -->
            <div class="form-group admin-only">
                <label for="credit" translate>Cr√©dit initial</label>
                <input 
                    id="credit"
                    type="number" 
                    formControlName="initialCredit"
                    min="0"
                    max="1000"
                    step="10"
                    placeholder="10"
                    />
                <small class="help-text">Cr√©dit accord√© √† l'utilisateur lors de la cr√©ation (par d√©faut: 10)</small>
            </div>

            <!-- Utilisation du composant register existant avec les donn√©es admin -->
            <div class="register-section">
                <app-register 
                    [prefilledData]="prefilledData"
                    [isAdminMode]="true"
                    [hidePasswordFields]="isEditMode"
                    (formReady)="onRegisterFormReady($event)"
                    (registerSubmit)="onRegisterSubmit($event)">
                </app-register>
            </div>

            <!-- Actions admin personnalis√©es -->
            <div class="admin-actions">
                <button 
                    type="submit" 
                    [disabled]="isLoading || !isFormValid()"
                    class="btn btn-primary"
                    >
                    <span *ngIf="isLoading">
                        <i class="spinner"></i>
                        {{ isEditMode ? 'Modification...' : 'Cr√©ation...' }}
                    </span>
                    <span *ngIf="!isLoading">
                        {{ isEditMode ? 'üíæ Modifier l\'utilisateur' : '‚ú® Cr√©er l\'utilisateur' }}
                    </span>
                </button>

                <button 
                    type="button" 
                    (click)="onCancel()" 
                    class="btn btn-secondary"
                    >
                    ‚ùå Annuler
                </button>

                <button 
                    *ngIf="isEditMode"
                    type="button" 
                    (click)="onDelete()" 
                    class="btn btn-danger"
                    [disabled]="isLoading"
                    >
                    üóëÔ∏è Supprimer
                </button>

                <button 
                    type="button" 
                    (click)="onPreview()" 
                    class="btn btn-info"
                    [disabled]="!isFormValid()"
                    >
                    üëÅÔ∏è Aper√ßu
                </button>
            </div>
        </form>

        <!-- Aper√ßu des donn√©es (optionnel) -->
        <div *ngIf="showPreview" class="preview-section">
            <h3>Aper√ßu des donn√©es utilisateur</h3>
            <div class="preview-content">
                <div class="preview-item">
                    <strong>Pseudo:</strong> {{ getPreviewData().pseudo }}
                </div>
                <div class="preview-item">
                    <strong>Nom complet:</strong> {{ getPreviewData().nom }} {{ getPreviewData().prenom }}
                </div>
                <div class="preview-item">
                    <strong>Email:</strong> {{ getPreviewData().email }}
                </div>
                <div class="preview-item">
                    <strong>R√¥le:</strong> {{ getRoleDisplayName(adminForm.get('selectedRole')?.value) }}
                </div>
                <div class="preview-item">
                    <strong>Cr√©dit initial:</strong> {{ adminForm.get('initialCredit')?.value || 10 }} Pts
                </div>
            </div>
        </div>
    </div>
</div>
